# ADR-001: Framework Agnostic Design

**Status**: Accepted
**Date**: 2025-01-21
**Decision Makers**: Architecture Team

## Context

AI-агенты разрабатываются на различных фреймворках: LangGraph, CrewAI, AutoGen, LangChain, и многих других. Новые фреймворки появляются регулярно, существующие устаревают (например, AutoGen прекращает активное развитие).

Нам нужна платформа для тестирования, которая не привязана к конкретному фреймворку.

## Decision

Мы принимаем **framework-agnostic** подход, где агент рассматривается как чёрный ящик с определённым протоколом взаимодействия (ATP Protocol).

### Ключевые принципы

1. **Агент = чёрный ящик**
   - Платформе неважно, как реализован агент внутри
   - Важен только контракт: вход (task) → выход (artifacts + metrics)

2. **Протокол как контракт**
   - JSON-based протокол, не зависящий от языка программирования
   - Схемы для валидации
   - Версионирование для backward compatibility

3. **Adapters для удобства**
   - Опциональные адаптеры для популярных фреймворков
   - Адаптеры — syntactic sugar, не обязательны

## Consequences

### Positive

- **Гибкость**: Команды могут использовать любой фреймворк
- **Longevity**: Платформа не устареет вместе с фреймворком
- **Сравнимость**: Можно сравнивать агентов на разных фреймворках
- **Простота интеграции**: Минимальные требования к агенту
- **Тестируемость**: Протокол можно тестировать независимо

### Negative

- **Overhead**: Нужно реализовать протокол для каждого агента
- **Limited features**: Нет доступа к внутренним деталям фреймворка
- **Maintenance**: Нужно поддерживать адаптеры для популярных фреймворков

### Risks

- Протокол может не покрывать все use cases → митигация: версионирование, расширяемость
- Адаптеры могут отставать от фреймворков → митигация: community contributions

## Alternatives Considered

### 1. Tight integration with one framework
Глубокая интеграция с одним фреймворком (например, LangGraph).

**Pros**: Больше возможностей, меньше overhead
**Cons**: Vendor lock-in, ограниченная аудитория

**Rejected**: Слишком рискованно в быстро меняющемся landscape.

### 2. Plugin-per-framework architecture
Каждый фреймворк имеет свой плагин с полной интеграцией.

**Pros**: Максимальные возможности для каждого фреймворка
**Cons**: Огромные затраты на поддержку, дублирование логики

**Rejected**: Не масштабируется.

### 3. Language-specific approach
Только Python агенты с определённым интерфейсом.

**Pros**: Проще реализовать
**Cons**: Исключает non-Python агентов

**Rejected**: Ограничивает adoption.

## Implementation Notes

1. Протокол определяется в `docs/04-protocol.md`
2. JSON Schema в `schemas/`
3. Адаптеры в `atp/adapters/`
4. Гайд по интеграции в `docs/06-integration.md`

## References

- ATP Protocol Spec: `docs/04-protocol.md`
- Integration Guide: `docs/06-integration.md`
